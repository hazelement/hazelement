<!doctype html>
<html lang="en" itemscope itemtype="http://schema.org/Person">
<head>
  <meta charset="utf-8">
  <!-- Site Meta Data -->
  <title>Use Pihole to Prevent Windows 10 Auto Update</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Haze">

  <link rel="shortcut icon" href="/favicon.ico">

  <!-- schema.org -->
  <meta itemprop="name" content="Coding Digests">
  <meta itemprop="image" content="">
  <meta itemprop="description" content="">

  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
  <!-- Style Meta Data -->
  <link rel="stylesheet" href="./theme/css/style.css" type="text/css" />
  <link rel="stylesheet" href="./theme/css/pygments.css" type="text/css" />

  <!-- Feed Meta Data -->

  <!-- Twitter Feed -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="">
  <meta name="twitter:image" content="">

<!-- <meta name="twitter:creator" content="">
<meta name="twitter:url" content="./use-pihole-to-prevent-windows-10-auto-update.html">
<meta name="twitter:title" content="Coding Digests ~ Use Pihole to Prevent Windows 10 Auto Update">
<meta name="twitter:description" content="<p>Use Pihole as DNS server to blacklist Windows 10 update domain so that auto updates can be blocked</p>">

<!- Facebook Meta Data -->
<!-- <meta property="og:title" content="Coding Digests ~ Use Pihole to Prevent Windows 10 Auto Update" />
<meta property="og:description" content="<p>Use Pihole as DNS server to blacklist Windows 10 update domain so that auto updates can be blocked</p>" />
<meta property="og:image" content="" /> --> 
</head>

<body>
  <!-- Sidebar -->
  <aside>
    <!--<center><a href="."><img id="avatar" src=""></a></center>-->
    <h1>Coding Digests</h1>
      <p>A bit from everyday</p>
    <br>


    <nav class="nav">
      <ul class="list-bare">
      
   
          <li><a class="nav__link" href="/">Home</a></li>

         
            <li><a class="nav__link" href="./pages/contact.html">Contact</a></li>
         
      </ul>
    </nav>

    <br>
    <form id="searchform" action="/search" onsubmit="return (this.elements['q'].value.length > 0)">
      <input id="searchbox" type="text" name="q" size="12" placeholder="Search">
    </form>
    <br>

    <div>
      <b>Tags</b><br>
                <a href="./tag/pelican.html"><font color="white">Pelican</font>
               </a>
                <a href="./tag/github.html"><font color="white">github</font>
               </a>
                <a href="./tag/networking.html"><font color="white">networking</font>
               </a>
                <a href="./tag/kubernetes.html"><font color="white">Kubernetes</font>
               </a>
                <a href="./tag/python.html"><font color="white">python</font>
               </a>
                <a href="./tag/cicd.html"><font color="white">CI/CD</font>
               </a>
                <a href="./tag/django.html"><font color="white">Django</font>
               </a>
                <a href="./tag/rst.html"><font color="white">rst</font>
               </a>
                <a href="./tag/ssh.html"><font color="white">ssh</font>
               </a>
                <a href="./tag/jenkins.html"><font color="white">Jenkins</font>
               </a>
    </div>

    <br>
    <div>
      <b>Categories</b><br>
                <a href="./category/android.html"><font color="white">Android</font>
               </a>
                <a href="./category/jenkins.html"><font color="white">Jenkins</font>
               </a>
                <a href="./category/kubernetes.html"><font color="white">Kubernetes</font>
               </a>
                <a href="./category/pelican.html"><font color="white">Pelican</font>
               </a>
                <a href="./category/pihole.html"><font color="white">pihole</font>
               </a>
                <a href="./category/restructuredtext.html"><font color="white">reStructuredText</font>
               </a>
    </div>

    <p class="social">
        <a href="https://github.com/hazelement" target="_blank" ><img src="./theme/images/icons/github.png"></a>
    </p>

    <!--
    <h2>Categories</h2>
    <ul class="navbar">
      <li><a href="./category/android.html">Android</a></li>
      <li><a href="./category/jenkins.html">Jenkins</a></li>
      <li><a href="./category/kubernetes.html">Kubernetes</a></li>
      <li><a href="./category/pelican.html">Pelican</a></li>
      <li class="active"><a href="./category/pihole.html">pihole</a></li>
      <li><a href="./category/restructuredtext.html">reStructuredText</a></li>
    </ul> 
    -->
  </aside>

  <!-- Content -->
  <article>
<section id="content">
    <article>
        <h2 class="post_title post_detail"><a href="./use-pihole-to-prevent-windows-10-auto-update.html" rel="bookmark" title="Permalink to Use Pihole to Prevent Windows 10 Auto Update">Use Pihole to Prevent Windows 10 Auto Update</a></h2>

        <div class="post_list">
            <span>By </span>
            <a href="./author/harry-zheng.html">@Harry Zheng</a>
            <span> in </span>
            <span class="post_category"><a href="./category/pihole.html" rel="bookmark" title="Permalink to pihole">[ pihole ]</a></span>
            <div>
                <span class="post_date">Sun 07 April 2019</span>
                <span>Tags : </span>
                    <span><a href="./tag/pihole.html">#Pihole, </a></span>
                    <span><a href="./tag/windows-10-update.html">#Windows 10 update, </a></span>
            </div>
        </div>

        <div class="entry-content blog-post">
            <h2>Pihole</h2>
<p>For those who haven't heard about Pihole, it's a light DNS service that can run on a device as small as a raspberry pi. It can be used as a DNS service to block certain unwanted domains. Most popular usage is to block advertisement and online tracking services. The GitHub page is <a href="https://github.com/pi-hole/pi-hole">here</a>. </p>
<h2>Running a Pihole in docker</h2>
<p>We will be using docker to run a Pihole service. Pihole has an official docker image that can be found <a href="https://github.com/pi-hole/docker-pi-hole">here</a>. A <code>docker-compose</code> file is also provided on their GitHub page. It's posted here for convenience. </p>
<div class="highlight"><pre><span></span>version: &quot;3&quot;

# More info at https://github.com/pi-hole/docker-pi-hole/ and https://docs.pi-hole.net/
services:
  pihole:
    container_name: pihole
    image: pihole/pihole:latest
    ports:
      - &quot;53:53/tcp&quot;
      - &quot;53:53/udp&quot;
      - &quot;67:67/udp&quot;
      - &quot;80:80/tcp&quot;
      - &quot;443:443/tcp&quot;
    environment:
      TZ: &#39;America/Chicago&#39;
      # WEBPASSWORD: &#39;set a secure password here or it will be random&#39;
    # Volumes store your data between container upgrades
    volumes:
       - &#39;./etc-pihole/:/etc/pihole/&#39;
       - &#39;./etc-dnsmasq.d/:/etc/dnsmasq.d/&#39;
    dns:
      - 127.0.0.1
      - 1.1.1.1
    # Recommended but not required (DHCP needs NET_ADMIN)
    #   https://github.com/pi-hole/docker-pi-hole#note-on-capabilities
    cap_add:
      - NET_ADMIN
    restart: unless-stopped
</pre></div>


<p>Let's assume <code>Pihole</code> is running on a local server with IP address <code>192.168.0.254</code>. On web browser, go to that IP address. A pihole page should show up. Click on <code>Did you mean to go to the admin panel?</code>. This will bring us to the admin page. Click on <code>login in</code> and enter the password defined in the <code>docker-compose.yml</code> file. </p>
<p><img alt="Pihole admin" src="../images/pihole_1.png"></p>
<h2>Configure Pihole to block Windows 10 update server</h2>
<p>Pihole's blocking mechanism are based on blacklist and whitelist. Navigate to <code>Setting &gt; Blocklists</code>. Here you can add as many lists as you want. There are many community list out there that block different types of services. </p>
<p><img alt="Pihole admin setting" src="../images/pihole_2.png"></p>
<p>You can see I have a lot of them added. At the bottom of the list, we can see a place where we can add more lists. </p>
<p><img alt="Pihole admin setting block" src="../images/pihole_3.png"></p>
<p>The URL we are using is from <a href="https://www.stadtmarketing-freifunk.de/WinUpdate.txt">here</a>. Many thanks to krathalan and in2016minewastaken from reddit. Enter the url and click on <code>Save and Update</code> to update the rules, </p>
<h2>Configure Windows to use the Pihole as DNS server</h2>
<p>There are 2 options here. Configure specific machines we would like to prevent auto update or apply this on all Windows 10 machines on the local network. </p>
<ol>
<li>To configure specific machines, just configure the DNS server on each machine to <code>192.168.0.254</code>. </li>
<li>To configure for all machines on the local network, configure router's DNS server to <code>192.168.0.254</code>. Refer to your router manual to setup this. </li>
</ol>
<p>And that's it! Next time Windows machines try to get an update, it will hit a wall at our DNS server and fail. </p>
        </div>
        <div class="post_list">
            <div class="entry-social">
                <span class="twitter"><a target="_blank" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;" title="Twitter" href="https://twitter.com/share?url=./use-pihole-to-prevent-windows-10-auto-update.html&text=Use Pihole to Prevent Windows 10 Auto Update&via="><img src="./theme/images/icons/twitter-s.png"></a></span>

                <span class="gplus"><a target="_blank" title="Google +" href="https://plus.google.com/share?url=./use-pihole-to-prevent-windows-10-auto-update.html&hl=fr" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img src="./theme/images/icons/google-s.png"></a></span>

                <span class="facebook"><a target="_blank" title="Facebook" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=700');return false;" href="https://www.facebook.com/sharer.php?u=./use-pihole-to-prevent-windows-10-auto-update.html&t=Use Pihole to Prevent Windows 10 Auto Update"><img src="./theme/images/icons/facebook-s.png"></a></span>

                <a  target="_blank" title="Linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=./use-pihole-to-prevent-windows-10-auto-update.html&title=Use Pihole to Prevent Windows 10 Auto Update" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;"><img src="./theme/images/icons/linkedin-s.png"></a>

                <span class="mail"><a href="mailto:?subject=Use Pihole to Prevent Windows 10 Auto Update&amp;body=Check out this article from Haze. ./use-pihole-to-prevent-windows-10-auto-update.html" title="Share by Email" target="_blank"><img src="./theme/images/icons/mail-s.png"></a></span>
            </div>
        </div>
        <div class="comments">
            <h2>Comments</h2>
            
            <div id="disqus_thread"></div>
            <script type="text/javascript">
            var disqus_identifier = "use-pihole-to-prevent-windows-10-auto-update.html";
            (function() {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//https-hazelement-github-io.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] ||
                 document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </article>
</section>
  </article>

  <!-- Footer -->
  <footer>
    <p>
      Blog powered by <a href="http://getpelican.com/">Pelican</a>, 
      which takes great advantage of <a href="http://python.org">Python</a>.
      Theme <a href="https://github.com/parbhat/pelican-blue">Pelican-Blue</a> by <a href="https://parbhatpuri.com/">@parbhat</a>.
    </p>
  </footer>


</body>
</html>